var Common={init:function(){Login.setLogin(),this.serviceInit("#explore-link","#explore-menu","#support-menu"),this.serviceInit("#support-link","#support-menu","#explore-menu"),this.scrollInit(),this.gotop(),this.setFastClick()},project:"wow",addFlash:function(a,b,c,d){var e={menu:"false",allowFullScreen:"false",allowScriptAccess:"true",wmode:"transparent",base:"."};"music"==arguments[4]&&(e.wmode="window"),swfobject.embedSWF(a,b,c,d,"9.0.0","","",e)},hasFlash:function(){return"undefined"!=typeof navigator.plugins&&"object"==typeof navigator.plugins["Shockwave Flash"]||window.ActiveXObject&&0!=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")?!0:!1},validate:{digits:function(a){var b=/^[0-9]+$/;return b.test(a)},mobile:function(a){var b=/^[1][3-8]\d{9}$/;return b.test(a)},email:function(a){var b=/^[0-9a-zA-Z+_.-]+@[0-9a-zA-Z_-]+\.[0-9a-zA-Z_.-]+$/;return b.test(a)},p_code:function(a){var b=/^\d{6}$/;return b.test(a)}},ieVersion:function(a){var b=window.navigator.userAgent.toLowerCase(),c=RegExp("msie "+a+".0","i");return $.browser.msie&&c.test(b)},videoWrap:function(a,b,c,d){var e='<object width="'+b+'" height="'+c+'" id="FPlayer" data="'+a+'" type="application/x-shockwave-flash"><param value="transparent" name="wmode" /><param value="true" name="allowFullScreen" /><param value="always" name="allowscriptaccess" /><param value="'+a+'" allownetworking="all" name="movie" /><param value="'+d+'&noPauAd=1" name="flashvars" /></object>';return e},showIosVideo:function(a,b,c){var d='<video width="'+b+'" height="'+c+'" controls="controls" autoplay="false" preload="auto"><source src="'+a+'" type="video/mp4"> 您的浏览器暂时无法播放此视频.</video>';return d},setVideo:function(a,b,c){var d="click";Common.isMobile()&&(d="touchstart"),a.on(d,function(){var a=$(this).attr("data-flv"),d=$(this).attr("data-mp4"),e="";e=Common.isMobile()?Common.showIosVideo(d,b,c):Common.videoWrap("http://v.163.com/swf/video/NetEaseFlvPlayerV3.swf",b,c,a),$.hos.lightBox(e,{model:!0})})},radioStyle:function(){var a=$(".radioInput"),b=$("a",a);b.click(function(){var a=$(this);a.addClass("checked").siblings().removeClass("checked")})},checkboxStyle:function(){var a=$(".checkboxInput"),b=$("a",a);b.click(function(){var a=$(this);a.toggleClass("checked")})},gotop:function(a){$(window).scroll(function(){var b=$(window).scrollTop(),c=$("#gotop");a||(a=200),b>a?c.show():c.hide()}),$.sc2.scrollTo({trigger:"#gotop"})},isIOS:function(){var a=/(iPhone|iPad|iPod)/gi;return a.test(navigator.userAgent)},isMobile:function(){var a=/(android|iPhone|iPad|iPod|mobile)/gi;return a.test(navigator.userAgent)},setNoTouchClass:function(){Common.isMobile()||$("body").addClass("no-touch")},serviceInit:function(a,b,c){var d,e=$(a),b=$(b),c=$(c);e.click(function(){return b.toggle(),c.hide(),!1}),e.mouseleave(function(){d=setTimeout(function(){b.hide()},800)}),e.mouseenter(function(){clearTimeout(d)}),b.mouseleave(function(){var a=$(this);a.hide()}),b.mouseenter(function(){clearTimeout(d)})},get_redirect_url:function(){var a=window.parent.location.href;return(a.indexOf("#")>0||a.indexOf("?")>0)&&(a=a.split("#")[0].split("?")[0]),a},logoutControl:function(){var a=this.get_redirect_url(),b=window.parent.location.protocol+"//"+window.parent.location.host;$(".commentAdminLogout").live("click",function(){location.href=b+"/comments/logout?target="+a})},getToken:function(){return $.cookie("_ANTICSRF")},juicerInit:function(){juicer.set({"tag::interpolateOpen":"{{","tag::interpolateClose":"}}","tag::noneencodeOpen":"{{{","tag::noneencodeClose":"}}}"})},scrollInit:function(){var a=$("#navWrap");a.fixed({marginTop:0}),Common.isMobile()?$("#headerFlash").css("background","url(http://heroes.nos.netease.com/1/images/common/top_flash_bg.jpg) no-repeat 0 -13px"):Common.addFlash("http://heroes.nos.netease.com/1/images/swf/top_flash.swf","headerFlash",780,220);var b=null,c=0,d=navigator.userAgent.toLowerCase();$(window).scroll(function(){"222px"==$("#navWrap").css("top")?($("#header").css("z-index",10),a.css("background-position","-9999px -9999px")):($("#header").css("z-index",99),a.css("background-position","0 0")),-1!=d.indexOf("chrome")&&($(window).scrollTop()>=335?$("#regFlash").hide():$("#regFlash").show());var e=$("#nav a.active");Common.isMobile()||e.find("#nav_flash").length||($("#nav a.active").append('<div id="nav_flash_wrap"><div id="nav_flash"></div></div>'),Common.addFlash("http://heroes.nos.netease.com/1/images/swf/nav_down.swf","nav_flash",140,100)),$("#nav_flash_wrap").css("opacity",1),null==b&&(b=setInterval(function(){var a=$(window).scrollTop();c==a&&(Common.ieVersion(7)||Common.ieVersion(8)?$("#nav_flash_wrap").css({opacity:0}):$("#nav_flash_wrap").animate({opacity:0},500),clearInterval(b),b=null)},800)),c=$(window).scrollTop()})},libs:{baseSlide:function(){var a=$(".ui-slider");a.each(function(a,b){var c=$(".ui-slider-pic",$(b)),d=c.children(),e=$(".ui-slider-txt",$(b)),f=e.children(),g=$(".prev",$(b)),h=$(".next",$(b)),i=$(".ui-slider-active",$(b)),j=d.index(i);g.click(function(){return j--,0>j&&(j=d.length-1),d.eq(j).siblings().hide().stop(!0,!0).end().fadeIn(),f.eq(j).siblings().hide().stop(!0,!0).end().fadeIn(),!1}),h.click(function(){return j++,j==d.length&&(j=0),d.eq(j).siblings().hide().stop(!0,!0).end().fadeIn(),f.eq(j).siblings().hide().stop(!0,!0).end().fadeIn(),!1})})},baseLightBox:function(a,b,c){var d='<div style="width:'+b+"px; height:"+c+'px;" class="hos_lightbox">'+a+"</div>";$.hos.lightBox(d,{model:!0})},lightImg:function(a,b,c){var d="",e="";"undefined"!=typeof b&&(d="width:"+b+"px;"),"undefined"!=typeof c&&(e="height:"+c+"px");var f='<div style="'+d+e+'" class="hos_lightbox"><img style="'+d+e+'" alt="" src="'+a+'"></div>';$.hos.lightBox(f,{model:!0})}},isObjectNull:function(a){var b=0;for(var c in a)b++;return 0==b?!0:!1},getData:function(a,b,c){if(Common.isObjectNull(b))var b={t:(new Date).getTime()};else b.t=(new Date).getTime();$.get(a,b,function(a){c(a)},"html")},setShare:function(a,b,c){window.jiathis_config={data_track_clickback:!1,summary:a,pic:c,title:b,hideMore:!1},$("body").append('<script src="http://v3.jiathis.com/code/jia.js?uid=1803378?v=5"></script>')},callFlash:function(a,b){var c;c=-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a],c.dogame(b)},setFlashHover:function(a,b){var c=$(a);c.hover(function(){var a=($(this),"over");Common.callFlash(b,a)},function(){var a=($(this),"out");Common.callFlash(b,a)})},setEvent:function(){return Common.isMobile()?"touchstart":"click"},setFastClick:function(){FastClick.attach(document.body)},getlogin:function(){var a=location.protocol+"//"+location.host,b=a+"/battlenet/login",c=a+location.pathname,d="http://account.bnet.163.com/battlenet/login?inner_client_id=wow&inner_redirect_uri=";return login_href=d+encodeURIComponent(b+"?redirect_url="+c)},weixinShare:function(a,b,c){Common.isMobile()&&(window.shareData={img_url:c,img_width:"90",img_height:"90",link:location.href,desc:a,title:b},document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(){WeixinJSBridge.invoke("sendAppMessage",shareData,function(a){_report("send_msg",a.err_msg)})}),WeixinJSBridge.on("menu:share:timeline",function(){WeixinJSBridge.invoke("shareTimeline",shareData,function(a){_report("timeline",a.err_msg)})})},!1))}};